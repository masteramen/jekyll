---
layout: post
title:  "关于final的所有 » java面试题"
title2:  "关于final的所有 » java面试题"
date:   2017-01-01 23:56:15  +0800
source:  "https://www.jfox.info/%e5%85%b3%e4%ba%8efinal%e7%9a%84%e6%89%80%e6%9c%89.html"
fileName:  "20170101275"
lang:  "zh_CN"
published: true
permalink: "2017/%e5%85%b3%e4%ba%8efinal%e7%9a%84%e6%89%80%e6%9c%89.html"
---
{% raw %}
Java有一个关键字final，一个变量可以被声明为final类型，一个final类型的变量只能被赋值一次。如果一个final变量被重复赋值将会出现编译错误。

## Effectively Final

一个变量当且仅当在如下的情况才会被认为是effectively

1.未被声明为final

2.只赋了一次值

最简单的方式去解释**effectively final**就是想象它加上了final修饰，如果这样修改后，程序仍然运行无误（在编译通过的情况下^0^），并且跟原来的运行结果一致，那么这个变量可以说是effectively final。

## final的好处

将局部变量限制为有效的不可变变量旨在让开发人员的更好的处理并发及线程安全的开发。 如果管理不当，可变字段始终是并发问题的潜在来源。 

## final关键字的使用

我觉得将变量，方法参数等声明为final是很好的习惯。它可以很好的提醒团队里的其它人，不要轻意的去修改它，抛开这个不提，声明为final，编译器在编译成class文件时，会对此进行很好的优化。

有很多的论据反对”在源文件中使用final关键字可以实现类文件的优化是不正确的“，强烈建议去读一下Robert Simons Jr的《**Hardcore Java**》关于final关键字的使用及优化的详情内容。

在一个应用中final关键字让你的代码的意图看起来会很明显，声明以后就不会被更改，这样很安全。

    public class FinalTest {
    
        public static final int N_ITERATIONS = 10_00_000;
    
        public static String testFinal() {
            final String a = "a";
            final String b = "b";
            return a + b;
        }
    
        public static String testNonFinal() {
            String a = "a";
            String b = "b";
            return a + b;
        }
    
        public static void main(String[] args) {
            long tStart, tElapsed;
    
            tStart = System.currentTimeMillis();
            for (int i = 0; i < N_ITERATIONS; i++)
                testFinal();
            tElapsed = System.currentTimeMillis() - tStart;
            System.out.println("Method with finals took " + tElapsed + " ms");
    
            tStart = System.currentTimeMillis();
            for (int i = 0; i < N_ITERATIONS; i++)
                testNonFinal();
            tElapsed = System.currentTimeMillis() - tStart;
            System.out.println("Method without finals took " + tElapsed + " ms");
    
        }
    
    }
    

　　运行结果：

    Method with finals took 5 ms
    Method without finals took 273 ms

## 总结

final可以使你声明的变量更安全，让你的代码看起来更清晰，Effective Java中也是提倡使用immutable class滴。
{% endraw %}