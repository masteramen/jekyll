---
layout: post
title:  "还在为画“类Word文档报表”而发愁吗？"
title2:  "还在为画“类Word文档报表”而发愁吗？"
date:   2017-01-01 23:57:23  +0800
source:  "https://www.jfox.info/%e8%bf%98%e5%9c%a8%e4%b8%ba%e7%94%bb%e7%b1%bbword%e6%96%87%e6%a1%a3%e6%8a%a5%e8%a1%a8%e8%80%8c%e5%8f%91%e6%84%81%e5%90%97.html"
fileName:  "20170101343"
lang:  "zh_CN"
published: true
permalink: "2017/%e8%bf%98%e5%9c%a8%e4%b8%ba%e7%94%bb%e7%b1%bbword%e6%96%87%e6%a1%a3%e6%8a%a5%e8%a1%a8%e8%80%8c%e5%8f%91%e6%84%81%e5%90%97.html"
---
{% raw %}
# 还在为画“类Word文档报表”而发愁吗？ 


​Word 是非常强大的文档编辑工具，一些行业制式文档都是使用Word来创建的，像教育行业的申请表，履历表，审批表等，像石油业的勘探记录表，记录报告，检测报告等，如房地产业的制式合同，不仅包含大量的文字描述，还会嵌入图片，表格等一些数据控件。

我们通常选择使用 Word 来创建这些文档，因为它有着极强的图文混排的能力能够实现集图表，表格，图片等组成的一个混合布局的复杂报表。但使用Word越是创建这些复杂的结构，越需要耗费过多的时间来“画”出这些复杂的样式， 且所有的数据都需要手动输入，无法与业务数据连接，所以更新也会更加困难。

在现代 BI 系统中绝不容忍如此低效，且非实时性的数据分析，因此我们必须寻求与时俱进的现代化数据分析工具，以助于高效的创建数据分析汇总的报表项。[葡萄城报表](https://www.jfox.info/go.php?url=http://www.grapecity.com.cn/enterprise-solutions/activereports_server/)可以很好的解决类Word文档类的报表创建，可快速创建复杂的图文混排样式，而且能够实时的进行数据更新。

# （一）类Word文档类报表特点

1.1 大量原始数据展示

这些数据往往存储在业务数据库中，但使用Word创建，将所需要看到的数据，手动输入对应的单元格当中，或是由多人维护更新，这样无法导致数据同步更新，而且容易出错。

1.2 图文混排

多个表格、图片、富文本、图表等组成一个混合布局的复杂报表，这些制式文档通常都包含既定的行业规范，所以对于排版要求非常严苛，因此需要按照既定的规范，来‘画’出复杂的样式，这样创建文档的难度又提高，也是十分低效的做法。

1.3 多页结构

特殊的首页和尾页要求，Word文档类报表较大的时候都有多页的结构，而且对于这些页都有不同的要求和规格。如：

- 
封皮:单面数据，常包含报告的基本信息，如报表名称，报告编号，单位名称，Logo 信息，条码信息等 

![](c522c44.png)

- 
详细数据：多页详细数据，主要由不同结构的数据组成，常包含，页眉页脚信息，详细数据区域。不同页对应的数据结构不一致。传统Word表格样式，详细数据部分，内容格式都不固定，没有规律，行列数量不固定，行高列宽不固定。内容项目为非固定格式，根据实际数据，动态选择内容呈现格式，多种布局并存。

![](6b4c2cb.png)

- 
结尾声明:文档类的尾部一般包含文档声明、总结等信息，常以大量文本输出为主，不同内容格式也是大有不同，葡萄城报表支持在同一页报表中，显示多种格式的文本内容。

![](944aa0c.jpg)

- 
首页和尾页的页眉页脚可单独控制：Word文档，在首页和尾页中不需要添加页眉，也不需要显示页号，只需要在内容页显示页眉。

![](a4a11ce.png)

- 
动态加载图片和调整图片数量

![](ef7f2b5.png)

- 
传统的Word表格样式，左边标题，右边内容项

![](5239d2a.png)

- 
动态生成详细数据

1.4 新型数据展示控件

现有的各行业报表为了更加信息化，现代化，因此会在报表中添加一些新型数据控件，如物流业常用的条码，插入特殊格式的文本等，所以在类Word文档类报表中通常存在一些特殊的字符或控件的输入和展示。

![](0fa48d1.png)

##  

# （二）创建类Word文档类报表

通常Word创建的文档有多种样式的数据呈现形式，多个表格、图片、富文本、图表等组成一个混合布局的复杂报表，同时支持多数据源绑定，每个组成部分可以有自己的独立数据源。这类报表因为信息量和数据量巨大，因此有一些非常特殊的报表需求，比如：首页/尾页不显示页面/页脚、表格跨页显示时标题行需要在每页重复显示便于查看数据、支持多张图片显示等。而这些复杂的报表需求，恰好是葡萄城报表非常强大功能所在。

类Word 报表，可以简单理解为所有使用Word制作的复杂表格，文案，合同类，履历类的文档，都以报表的形式呈现出来。以呈现多层结构信息为主，有严格的格式要求。类Word报表通常包含多个模块显示信息。模块之间结构和数据各有不同，对于页眉和页脚内容也有严格的要求等文档类的需求。

接下来我们就来展示使用葡萄城报表创建档案类报表，档案类报表常见于人员管理系统，这一类报表常包含个人基本信息介绍，经历信息，评价，结论等信息。该类报表的特点： 标题在左，右边为内容；每项内容单元格的样式都是有严格要求的，通常报表的上半部分信息密集，下半部分为大量的数据填报信息，因此占用空间比较大。该类报表通常有固定的页数。

## 2.1  报表原型

档案类报表通常包含如下模块：基本信息，职务信息，主要经历，审批信息，接下来我们来演示如何使用葡萄城报表矩表控件来创建

![](425856f.png)

2.2  报表结构分析

1. 左侧为标题，右侧为内容

2. 内嵌图片控件

3. 详细信息高度不一致

4. 跨行单元格合并

## 2.3 实现思路 

1. 使用矩表控件

2. 添加多级静态列

3. 跨行单元格合并

## 2.4 报表实现

1. 新建RDL 报表模板

2. 添加数据源和数据集

![](9e09284.png)

![](248c028.png)

3.  添加矩表控件

4.  删除分组单元格

4.1 因为不涉及动态列，首先需要删除列分组和行分组单元格。

删除 行分组；并设置该行Size 的Width 属性为0

![](3bcb241.png)

![](981d7a3.png)

4.2 删除列分组

右键单击列分组单元格，选择“列分组”-》“删除分组”；

并设置该列Size 的Width 属性为0

![](e01c27b.png)

5. 构造基本信息模块

5.1 插入静态列

右键选中TextBox1 插入列，右侧；（重复执行7次）

![](503b953.png)

效果图：

![](869e84c.png)

5.2 插入静态行

右键选中 TextBox1插入行，下方;(重复执行6次)

![](11b7419.png)

效果图：

![](0b8c872.png)

5.3 输入项标题

效果图：

![](06f1928.png)

5.4 合并单元格

![](1e8cef8.png)

6. 添加模块 

6.1 选中“学历学位”单元格，插入行（执行三次），输入职务信息。 

![](02f289a.png)

7. 添加详细信息模块

该模块每个内容项对应一行内容，显示大量的文本；因此需要进行单元格合并，设置足够的行高； 

7.1 添加静态行

选择“拟免职务”，选择“插入行”-》“下方”（执行6次）

![](0e702e0.png)

效果：

![](2cb2cd5.png)

7.2 合并单元格 

![](ef44342.png)

8. 调整样式

![](35c9eb2.png)

9. 最终运行效果

![](111aa6f.png)

转载请注明出自：葡萄城报表
{% endraw %}