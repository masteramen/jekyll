---
layout: post
title:  "说说我们自建IDC的规划，和走过的那些坑"
title2:  "说说我们自建IDC的规划，和走过的那些坑"
date:   2017-01-01 23:52:18  +0800
source:  "http://www.jfox.info/%e8%af%b4%e8%af%b4%e6%88%91%e4%bb%ac%e8%87%aa%e5%bb%baidc%e7%9a%84%e8%a7%84%e5%88%92%e5%92%8c%e8%b5%b0%e8%bf%87%e7%9a%84%e9%82%a3%e4%ba%9b%e5%9d%91.html"
fileName:  "20170101038"
lang:  "zh_CN"
published: true
permalink: "%e8%af%b4%e8%af%b4%e6%88%91%e4%bb%ac%e8%87%aa%e5%bb%baidc%e7%9a%84%e8%a7%84%e5%88%92%e5%92%8c%e8%b5%b0%e8%bf%87%e7%9a%84%e9%82%a3%e4%ba%9b%e5%9d%91.html"
---
{% raw %}
##  1. 公司机房发展史 

 随着互联网行会的飞速发展，公司对于IT信息方面的应用的越来越多。如今任何公司都离不开网络，小的几十至上百人员上网需求，一台路由器加数台交换机组成公司网络。大的成千上万的客户端全球分公司互联，防火墙、VPN、认证准入、高端路由交换，成百上千齐全的网络设备来保障公司正常网络需求。 

 一般公司成立之初、员工和业务较少、网络设备和服务器也就数台。机房就是一个小房间、几台设备、一个机柜搞定。 

![](cc1cc95.png)

 随着公司业务规模、人员扩展；小机房里的机柜也开始成倍的增加。这一阶段主要还是在以扩展网络接入为主题。 

![](d0bb8e5.png)

 当公司规模逐渐扩展、业务需求也更加复杂和多样化。原本只规划用做网络接入的机房已经无法满足这些需求，众多的内部业务需要用服务器来支撑，无稳定的环境为公司提供持续的服务。为保障这些设备能够放在一个良好的环境当中运行，只能选择是托管或自建服务器机房。于是乎开始规划建设自己的数据中心机房。 

![](8651d8a.png)

![](0bf308d.png)

##  2. 自建专业机房的必要性 

###  2.1 需求导向 

** 2.1.1 内部业务扩展 **

 公司网络环境比较复杂，网络规划非常重要。随着公司规模的不断扩展。网络设备、公司网站、邮件系统、OA系统、数据库系统、文件服务器、FTP服务器、内网研发平台服务器等的大量需求。分散式的小机房已无法满足需求。而自建机房则可以对办公数据、研发数据等进行更加合理网络规划与划分。 

** 2.1.2 大量需求集中管理的高效性 **

 随着公司规模的壮大，企业人员规模、内部业务系统也都随之扩展。内部用网设备规模日渐庞大，大量的需求分布在大厦的各个楼层，集中管理是大势所趋。网络设备、服务器及其它IT应用的设备都可以进行集中的管理，可灵活的规划自有资源的使用。应急情况处理方便且高效，如日常发生服务器突然宕机或其他故障可以在第一时间进行现场重启和维护。减少了很多的沟通成本提高维护效率。 

###  2.2 保障研发数据安全 

 互联网行业普及的当下企业的信息安全受到越来越多的重视。在保护好研发数据安全及企业其他的无形资产信息资产的大前提下，我们必须做更多的思考和规划。那么如果能在一个集中化管理的环境中对所以终端网络权限进行统一的设定；同时将研发环境和线上运营环境完全独立开来，对研发数据进行重点的隔离保护，报障重要的数据不被外泄。这些需求使得自建服务器机房无疑成为了刚需。 

###  2.3 虚拟化的规模优势 

 互联网行业尤其是软件研发企业，内部对研发环境服务器的需求是非常大的。这便面临需要在虚拟化和物理服务器器之间的选择。相信大家都能理解，虚拟化方案在集中管理、扩展性、故障转移等方面具备的优势非常明显。但虚拟化架构的基础投入并不低，要实现对物理服务器的成本优势还需要一个大的前提就是规模效应。而我们现在正好具备这一前提，那自然要让虚拟化大行其道。 

##  3. 机房建设规划 

 机房作为公司核心网络设备，办公应用、内部软件研发等业务硬件支撑的心脏。机房的建设、区域划分、设备选型等前期需要做充足的规划，保证了后期的健康运行和扩容。 

 机房的建设分为多个系统，装饰系统、电力系统、制冷、综合布线、新风、防雷、消防等等”。在这里我们主要是介绍几个关键系统的前期规划和设备选型。 

###  3.1 机房面积规划 

 根据网络设备数量、服务器数量、服务器设备增长预留余量。机房配置600*950服务器机柜50个，2排可放置100台塔式服务器机架。用于搬运设备的信道不小于1.5米；机柜正面和背面正常距离为1米至1.2米。根据容量计算，主设备间需要140平方米。 

 辅助区的面积一般为主机房的0.5至1倍。监控室的面积按3.5至4平方米计算。结合写字楼的实际场地、辅助区规划100平方米。机房总面积规划为240平方米。 

###  3.2 机房功能区域规划 

![](de1219d.png)

 精密空调区：用于摆放三台精密空调，为机房制冷； 
网络设备区域：用于放置公司核心网络设备、呼叫设备、机房服务器的接入层网络设备和机房接入层配线架； 
存储区域：放置存储设备区域； 
服务器区域：服务器机柜集中区域； 
UPS配电间：安放UPS电池柜和2台配电柜； 
空调外机间：放置精密空调外机； 
消防设备区域：放置消防气瓶和消防设备区域； 
监控室：日常办公，机房管理和监控； 
缓冲区：用于进出机房人员换衣、换鞋的区域，同时也是防跟随确认区，进入机房需要进过两道门禁刷，以保证安全。 

###  3.3 制冷系统 

 由于机房设备都会释放大量热量，为保持这些设备安全稳定地运行，就一定要使机房室内保持恒定的温度，空调系统的制冷循环部分就必须为机房源源不断地提供制冷量，同时也具有除湿的功能。 

 机柜热量循环： 

![](7de768f.png)

** 3.3.1 制冷规划和选型 **

 制冷系统承载通常计算采用“功率和面积法”计算机房总冷量比较准确；机房主要的热负荷来源于设备的发热量及维护结构的热负荷。根据以往经验，除主要的设备热负荷之外的其他负荷，如机房照明负荷、建筑维护结构负荷、补充的新风负荷、人员的散热负荷等可根据机房的面积进行估算，鉴于机房的实际情况，环境热负荷取180W/m2进行计算。 

 采用“功率及面积法”计算机房热负荷： 
Qt=Q1+Q2 
Qt:总制冷量(KW) 
Q1:室内设备负荷(=设备功率×0.8) 
Q2:环境热负荷(=0.1KW/m²×机房面积) 

 具体选型过程如下： 
Qt=Q1+Q2 
Qt:总制冷量(KW) 
Q1:室内设备负荷(=设备功率×0.8) 
Q2:环境热负荷(=0.1KW/m²×机房面积) 
Q1=120KW*0.8=96KW 
Q2=0.1KW/m²*180/m²=18KW 

 所以180平方机房推算所需要的总制冷量公式： 
Qt=Q1+Q2=96KW+18KW=114KW 

 所以理论上180平方机房应配置总制冷量110KW左右的精密空调;以满足机房的相关需求 

 根据计算结果，机房采用3台30KW功率的精密空调，一般情况下开启2台,还有一台精密空调备用,一个月轮询一次。机房的温度和湿度分别维持在23℃±2℃、50％RH±5％。 

![](8f2d0fa.png)

** 3.3.2 设备选型 **

 1、备份自动切换功能、当群组中机组故障时备用机组自动投入运行、提高空调系统的可靠性； 
2、轮巡：定时切换到备份机组； 
3、根据机房内热负荷的变化自动控制机组中空调机的运行数量；达到节能的目的； 
4、具有标准的报警功能：高温报警、低温报警、高湿报警、低湿报警、系统高压报警、系统低压报警、滤网堵报警、风量丢失报警、其他用户自定义报警等； 
5、国产知名品牌、价格相对实惠，售后有保障； 
6、采用下送风，上回风方式送风，这种方式送风均匀，噪音小； 
7、功率30KW左右。 

 机房精密空调2台使用、一台备用。在精密空调的设备选型上、出于成本考虑，选择国内口碑不错的品牌即可。 

###  3.4 电力系统 

** 市电功率 **

 电力系统作为机房至关重要的系统，出现故障影响非常大。在配电规划上也要考虑到一定的余量。 
机房主要电力负荷： 
空调：30KW*3=90KW 
照明：8KW 
新风
{% endraw %}