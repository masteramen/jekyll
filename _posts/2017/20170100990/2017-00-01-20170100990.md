---
layout: post
title:  "提高应用程序可用性的五个要点"
title2:  "提高应用程序可用性的五个要点"
date:   2017-01-01 23:51:30  +0800
source:  "http://www.jfox.info/%e6%8f%90%e9%ab%98%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%8f%af%e7%94%a8%e6%80%a7%e7%9a%84%e4%ba%94%e4%b8%aa%e8%a6%81%e7%82%b9.html"
fileName:  "20170100990"
lang:  "zh_CN"
published: true
permalink: "%e6%8f%90%e9%ab%98%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%8f%af%e7%94%a8%e6%80%a7%e7%9a%84%e4%ba%94%e4%b8%aa%e8%a6%81%e7%82%b9.html"
---
{% raw %}
# 提高应用程序可用性的五个要点 


可用性问题通常会在你最想不到的地方出现，许多问题都是系统性的问题，而不仅仅是代码的问题。本文提出了五个要点能够帮助你的系统在规模增长的同时保证高可用性。 
如您对可用性不是很了解，试试在微信后台回复“可用性”来了解更多。 
相关图书推荐，《可伸缩架构：面向增长应用的高可用》

　　构建一个高可用、可伸缩的应用程序不是一件容易的事，也不会是天上掉下来的馅饼。问题总会以你从未预期的方式出现，让你精心设计的功能对所有用户都停止工作。

　　这些可用性问题通常会在你最想不到的地方出现，甚至一些最严重的问题会来自于最不可能出现的地方。

一次简单的图标故障 
这发生在我亲身经历的一个应用程序中，是一次因为忽视依赖故障的典型案例。该程序向用户提供了一个服务，为每个页面顶部提供一个自定义的图标，来表示当前登录的用户。这个图标由一个第三方系统负责生成。 
有一天，这个生成图标的第三方系统发生了故障。我们的应用程序却假设该系统总是会正常运行，因此并不知道如何处理这种情况。结果是，我们的应用程序也跟着发生故障。我们整个系统仅仅是因为图标生成这样一个非常小的“功能”，导致无法提供任何服务。 
如何才能避免这样的问题呢？如果我们能够预料到第三方系统可能发生故障，就可以在设计过程中考虑到这个故障发生的场景，从而发现我们的应用程序也会随之发生故障。这样，我们就能添加一些逻辑来检查第三方服务，在问题发生时删除图标，或者在问题发生时捕获错误，避免它传递下去并影响页面的其他部分。 
一次小小的检查和一些错误恢复机制，就可以帮助应用程序保持正常运行。否则，我们的应用程序就会经历严重的服务中断。 
所有这一切都是因为缺少了一个图标。

　　没人有能够预料到问题会在何处发生，也不可能依靠测试来发现所有这些问题。许多问题都是系统性的问题，而不仅仅是代码的问题。

　　为了发现这些可用性的问题，我们需要后退一步，系统地去了解应用程序的运行机制。以下是五个你可以关注、并且应当关注的要点，它们能够帮助你的系统在规模增长的同时保证高可用性：

- 时刻考虑应对故障
- 时刻考虑如何伸缩
- 缓和风险
- 监控可用性
- 以可预期及明确的方式来处理可用性问题

让我们来详细讲解其中的每一个要点。

# 要点1 ：时刻考虑应对故障

　　正如Amazon 的CTO Werner Vogels 所说，“所有事情每时每刻都会失败”。你应当提前为应用程序和服务发生故障而做出计划。问题迟早会产生。不过现在，我们要讲的是如何解决它。

　　假设你的应用程序发生了故障，那么它是如何发生的？当你构建系统的时候，应当在设计和实现的方方面面都考虑可用性。例如：

## 设计

　　你有考虑过任何设计模式吗？你有使用它们来帮助你提升软件的可用性吗？

　　通过使用一些设计模式，例如捕获底层异常、重试逻辑和断路器，可以帮助你捕获错误并尽可能避免影响其他功能。这样，你就能够限制问题的影响范围，即使应用程序的某些部分出现问题，依然能够提供其他一些有用的功能。

## 依赖

　　如果你依赖的组件出现了故障，你会怎样做？你如何进行重试？如果问题是一个无法恢复的（硬件）故障，你会怎样做？如果是一个可恢复的（软件）故障呢？

　　断路器模式在处理依赖故障时非常有用，因为它们可以降低依赖故障对你的系统的影响。

　　如果没有断路器，你可能会因为依赖故障而降低系统的性能（例如，需要一个很长的超时机制来检测故障）。而使用了断路器，你可以“放弃”并停止使用某个依赖，直到你确认它已经恢复了正常工作。

## 用户

　　如果出现问题的原因是系统的某个用户，你会怎样做？你能够处理海量的请求吗？你能够限制海量的流量吗？你能够处理传入的垃圾数据吗？如果数据量非常大，你会怎样做？

　　有些时候，拒绝式服务可能来自于“友方”。例如，用户可能会因为看到一个临时活动，而导致大量请求增加。或者，用户程序中的一个bug，可能导致他们向你的应用程序拼命地发送请求。如果这样的事情发生了，你会怎样做？流量突增会让你的应用程序宕机吗？或者你能否检测出这种问题，通过限制请求的速度来降低
{% endraw %}