---
layout: post
title:  "理解数据仓库中星型模型和雪花模型"
title2:  "理解数据仓库中星型模型和雪花模型"
date:   2017-01-01 23:53:14  +0800
source:  "https://www.jfox.info/%e7%90%86%e8%a7%a3%e6%95%b0%e6%8d%ae%e4%bb%93%e5%ba%93%e4%b8%ad%e6%98%9f%e5%9e%8b%e6%a8%a1%e5%9e%8b%e5%92%8c%e9%9b%aa%e8%8a%b1%e6%a8%a1%e5%9e%8b.html"
fileName:  "20170101094"
lang:  "zh_CN"
published: true
permalink: "2017/%e7%90%86%e8%a7%a3%e6%95%b0%e6%8d%ae%e4%bb%93%e5%ba%93%e4%b8%ad%e6%98%9f%e5%9e%8b%e6%a8%a1%e5%9e%8b%e5%92%8c%e9%9b%aa%e8%8a%b1%e6%a8%a1%e5%9e%8b.html"
---
{% raw %}
星型模是一种多维的数据关系，它由一个事实表和一组维表组成。每个维表都有一个维作为主键，所有这些维的主键组合成事实表的主键。强调的是对维度进行预处理，将多个维度集合到一个事实表，形成一个宽表。这也是我们在使用hive时，经常会看到一些大宽表的原因，大宽表一般都是事实表，包含了维度关联的主键和一些度量信息，而维度表则是事实表里面维度的具体信息，使用时候一般通过join来组合数据，相对来说对OLAP的分析比较方便。 

（二）雪花模型图示如下： 

![](169c36e.jpg)
当有一个或多个维表没有直接连接到事实表上，而是通过其他维表连接到事实表上时，其图解就像多个雪花连接在一起，故称雪花模型。雪花模型是对星型模型的扩展。它对星型模型的维表进一步层次化，原有的各维表可能被扩展为小的事实表，形成一些局部的 “层次 ” 区域，这些被分解的表都连接到主维度表而不是事实表。雪花模型更加符合数据库范式，减少数据冗余，但是在分析数据的时候，操作比较复杂，需要join的表比较多所以其性能并不一定比星型模型高。 

（三）星型模型和雪花模型的优劣对比： 

![](4cbe7cb.jpg)
（四）应用场景 

星型模型的设计方式主要带来的好处是能够提升查询效率，因为生成的事实表已经经过预处理，主要的数据都在事实表里面，所以只要扫描实时表就能够进行大量的查询，而不必进行大量的join，其次维表数据一般比较少，在join可直接放入内存进行join以提升效率，除此之外，星型模型的事实表可读性比较好，不用关联多个表就能获取大部分核心信息，设计维护相对比较简答。 

星型模型的设计方式是比较符合数据库范式的理念，设计方式比较正规，数据冗余少，但在查询的时候可能需要join多张表从而导致查询效率下降，此外规范化操作在后期维护比较复杂。 

（五）总结 

通过上面的对比，我们可以发现数据仓库大多数时候是比较适合使用星型模型构建底层数据Hive表，通过大量的冗余来提升查询效率，星型模型对OLAP的分析发动机支持比较友好，这一点在Kylin中比较能体现。而雪花模型在关系型数据库中如MySQL，Oracle中非常常见，尤其像电商的数据库表。在数据仓库中雪花模型的应用场景比较少，但也不是没有，所以在具体设计的时候，可以考虑是不是能结合两者的优点参与设计，以此达到设计的最优化目的。
{% endraw %}